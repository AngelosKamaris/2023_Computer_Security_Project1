## Open eClass 2.3

Το repository αυτό περιέχει μια __παλιά και μη ασφαλή__ έκδοση του eclass.
Προορίζεται για χρήση στα πλαίσια του μαθήματος
[Προστασία & Ασφάλεια Υπολογιστικών Συστημάτων (ΥΣ13)](https://ys13.chatzi.org/), __μην τη
χρησιμοποιήσετε για κάνενα άλλο σκοπό__.


### Χρήση μέσω docker
```
# create and start (the first run takes time to build the image)
docker-compose up -d

# stop/restart
docker-compose stop
docker-compose start

# stop and remove
docker-compose down -v
```

To site είναι διαθέσιμο στο http://localhost:8001/. Την πρώτη φορά θα πρέπει να τρέξετε τον οδηγό εγκατάστασης.


### Ρυθμίσεις eclass

Στο οδηγό εγκατάστασης του eclass, χρησιμοποιήστε __οπωσδήποτε__ τις παρακάτω ρυθμίσεις:

- Ρυθμίσεις της MySQL
  - Εξυπηρέτης Βάσης Δεδομένων: `db`
  - Όνομα Χρήστη για τη Βάση Δεδομένων: `root`
  - Συνθηματικό για τη Βάση Δεδομένων: `1234`
- Ρυθμίσεις συστήματος
  - URL του Open eClass : `http://localhost:8001/` (προσοχή στο τελικό `/`)
  - Όνομα Χρήστη του Διαχειριστή : `drunkadmin`

Αν κάνετε κάποιο λάθος στις ρυθμίσεις, ή για οποιοδήποτε λόγο θέλετε να ρυθμίσετε
το openeclass από την αρχή, διαγράψτε το directory, `openeclass/config` και ο
οδηγός εγκατάστασης θα τρέξει ξανά.

## 2023 Project 1

Εκφώνηση: https://ys13.chatzi.org/assets/projects/project1.pdf


### Μέλη ομάδας

- 1900041, Ιάσονας Γιώτης
- 1900070, Άγγελος Καμάρης

### Report

### Πρώτο Κομμάτι

- SQL INJECTIONS:

 Στο αρχικό site για την προστασία από sql injections, υπάρχει το φίλτρο mysql_real_escape_string. Δεν καταφέραμε να βρούμε τρόπο να σπάσουμε αυτήν την άμυνα καθώς η ίδια η 
sql στην αρχή χρησιμοποιεί mysql_query('SET NAMES utf8'); κάτι το οποίο την καθιστά ασφαλή καθώς δεν έχει ευάλωτους χαρακτήρες, (όπως θα είχε η gbk π.χ). Παρόλα αυτά υπάρχουν σελίδες που τα inputs δεν φιλτράρονται. Μερικά παραδείγματα είναι κατά την δημιουργία και την επεξεργασία στοιχείων μαθητή, ενώ τα πεδία username και password, φιλτράρονται, τα υπόλοιπα (email, name, prename, am) δεν φιλτράρονται , (στο am δεν ελέγχεται καν αν θα μπει αριθμός). Με αυτόν τον τρόπο κάποιος μπορεί να βάλει: ', prenom = (SELECT pass FROM (SELECT password as pass FROM user WHERE user_id = 1) AS p), --  , στο επώνυμο, και να αποθηκευτεί έτσι στο όνομα ο κωδικός του admin. Αντιστοίχως ευάλωτα είναι και τα περισσότερα πεδία στην περιοχή συζητήσεων, καθώς αν στα url των σελιδων viewtopic, newtopic και reply, καθώς βάζοντας sql injections στην μεταβλητή topic ή forum, για το newtopic, θα εμφανιστεί στα breadcrumps, ή στον τίτλο, το hash του κωδικού του admin. (π.χ. το: topic=1)and 1=2 union select 1,password from eclass.user --   [το topic δεν τσεκάρει αν εισάγετε αριθμός]), στο viewtopic, μας δίνει τον κωδικό του admin. Στο ανέβασμα αρχείων, ένα αρχείο με το όνομα: ', (SELECT password FROM eclass.user WHERE user_id = '1')); -- ' , θα πάρουμε το hash του admin, στα σχόλια της εργασίας. Τέλος κατά την απεγγραφή από το μάθημα  υπάρχει η μεταβλητή cid στο url, η οποία μπορεί να μας γυρίσει το hash του admin. Υπάρχουν και επιθέσεις σε σελίδες που αφορούν τον admin, σε αυτές θα αναφερθούμε στα csrf.
  Για την καταπολέμηση των από πάνω προβλημάτων, έβαλα prepared statements σε όσες περισσότερες σελίδες μπορούσα, ασχέτως αν είχαν ήδη φίλτρο ή όχι, χρησιμοποιόντας mysqli, σε σελίδες που μπορούσε να χρησιμοποιηθεί, αλλιώς έβαζα φίλτρο στις υπόλοιπες (ακόμα και σε σελίδες που δεν μπορούσα να κάνω επίθεση). Άλλο ένα λάθος που βρήκα ήταν ότι για να τρέξει η sql, καλούνταν η συνάρτηση db_query, η οποία σε περίπτωση λάθους εκτύπωνε το αποτέλεσμα του query, κάτι το οποίο δεν επιτρέπω. Τέλος σε μεταβλητές που εισάγωνται ως αριθμητικό ποσό, αλλά δεν ελέγχονται, βάζω να εισάγεται string, ώστε με το φίλτρο να καταπολεμάται το πρόβλημα των επιθέσεων.


Συμπληρώστε εδώ __ένα report__ που
- Να εξηγεί τι είδους αλλαγές κάνατε στον κώδικα για να προστατέψετε το site σας (από την κάθε επίθεση).
- Να εξηγεί τι είδους επιθέσεις δοκιμάσατε στο αντίπαλο site και αν αυτές πέτυχαν.
